{{ ansible_managed | comment }}

interface={{ wifi_eap_iface }}
dhcp-range=set:{{ wifi_eap_iface }},{{ wifi_eap_dhcp.start }},{{ wifi_eap_dhcp.end }},{{ wifi_eap_ipaddr | ansible.netcommon.ipaddr('netmask') }},{{ wifi_eap_dhcp.lease_time }}

# gateway addr
dhcp-option={{ wifi_eap_iface }},3,{{ wifi_eap_ipaddr | ansible.netcommon.ipaddr('address')  }}

# DNS
dhcp-option={{ wifi_eap_iface }},6,{{ nameservers | join(',') }}

# DNS for IPv6
dhcp-option={{ wifi_eap_iface }},option6:dns-server{% for ns in wifi_eap_ra.dns %},[{{ ns }}]{% endfor %}

# Read configuration generated by openresolv
conf-file=/etc/dnsmasq-conf.conf
resolv-file=/etc/dnsmasq-resolv.conf

{% for ns in nameservers %}
server={{ ns }}
{% endfor %}

{% for ns in wifi_eap_ra.dns %}
server={{ ns }}
{% endfor %}